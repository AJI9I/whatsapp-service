/**
 * –ë—É—Ñ–µ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –≤–æ –≤—Ä–µ–º—è —Å–µ—Å—Å–∏–∏
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
 */

// –ë—É—Ñ–µ—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
const productsBuffer = [];

/**
 * –î–æ–±–∞–≤–ª—è–µ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä
 * @param {Object} productData - –î–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–µ
 */
export function addProduct(productData) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  if (!productData || !productData.model) {
    console.error('‚ö†Ô∏è  –ü–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –±–µ–∑ –º–æ–¥–µ–ª–∏:', productData);
    return;
  }
  
  // –î–æ–±–∞–≤–ª—è–µ–º timestamp –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª—É—á–µ–Ω–∏—è
  // –ï—Å–ª–∏ timestamp —É–∂–µ –µ—Å—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ, –∏–Ω–∞—á–µ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
  const product = {
    ...productData,
    timestamp: productData.timestamp || new Date().toISOString(),
    id: productData.id || `${Date.now()}_${Math.random().toString(36).substring(7)}` // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
  };
  
  productsBuffer.push(product);
  
  // –õ–æ–≥–∏—Ä—É–µ–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
  if (process.env.NODE_ENV === 'development') {
    console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä: ${product.model} (–≤—Å–µ–≥–æ: ${productsBuffer.length})`);
  }
}

/**
 * –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏–∑ –±—É—Ñ–µ—Ä–∞
 * @returns {Array} –ú–∞—Å—Å–∏–≤ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–µ—Ä–≤—ã–º–∏)
 */
export function getProducts() {
  // –°–æ–∑–¥–∞–µ–º –∫–æ–ø–∏—é –º–∞—Å—Å–∏–≤–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ - –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–≤—ã–º–∏
  const products = [...productsBuffer];
  products.reverse();
  
  // –õ–æ–≥–∏—Ä—É–µ–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
  if (process.env.NODE_ENV === 'development') {
    console.log(`üì¶ –ü–æ–ª—É—á–µ–Ω–æ ${products.length} —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –±—É—Ñ–µ—Ä–∞`);
  }
  
  return products;
}

/**
 * –û—á–∏—â–∞–µ—Ç –±—É—Ñ–µ—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
 */
export function clearProducts() {
  productsBuffer.length = 0;
}

/**
 * –ü–æ–ª—É—á–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –±—É—Ñ–µ—Ä–µ
 */
export function getProductCount() {
  return productsBuffer.length;
}

