<!DOCTYPE html>
<html lang="ru" dir="ltr" data-nav-layout="vertical" data-theme-mode="light" data-header-styles="light" data-menu-styles="light" data-toggled="open">

<head>
    <!-- Meta Data -->
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>WhatsApp Service - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º</title>
    <meta name="Description" content="WhatsApp Service –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–µ—Ä–µ–∑ Ollama">
    
    <!-- Favicon -->
    <link rel="icon" href="/bootstrap-theme/assets/images/brand-logos/favicon.ico" type="image/x-icon">
    
    <!-- Bootstrap Css -->
    <link id="style" href="/bootstrap-theme/assets/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Style Css -->
    <link href="/bootstrap-theme/assets/css/styles.min.css" rel="stylesheet">
    
    <!-- Icons Css -->
    <link href="/bootstrap-theme/assets/css/icons.css" rel="stylesheet">
    
    <!-- Node Waves Css -->
    <link href="/bootstrap-theme/assets/libs/node-waves/waves.min.css" rel="stylesheet">
    
    <!-- Simplebar Css -->
    <link href="/bootstrap-theme/assets/libs/simplebar/simplebar.min.css" rel="stylesheet">
    
    <!-- –û–±—â–µ–µ –º–µ–Ω—é -->
    <script src="/menu.js"></script>
    
    <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å—Ç–∞—Ç—É—Å–∞ WhatsApp -->
    <script src="/whatsapp-status.js"></script>
    
    <!-- Fix for missing DOM elements - MUST be before other scripts -->
    <script>
        // Global error handler to prevent script errors from breaking the page
        window.addEventListener('error', function(e) {
            const errorMessage = e.message || '';
            const errorFilename = e.filename || '';
            
            if (errorMessage.includes('Cannot read properties of null') ||
                errorMessage.includes('classList') ||
                errorMessage.includes('addEventListener') ||
                errorMessage.includes('appendChild') ||
                errorFilename.includes('defaultmenu.min.js') ||
                errorFilename.includes('custom-switcher.min.js') ||
                errorFilename.includes('custom.js')) {
                // –ü–æ–¥–∞–≤–ª—è–µ–º –æ—à–∏–±–∫—É –±–µ–∑ –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã
                e.preventDefault();
                e.stopPropagation();
                return true;
            }
        }, true);
        
        // Ensure all required DOM elements exist before scripts execute
        (function() {
            let isEnsuring = false;
            
            window.ensureElements = function ensureElements() {
                if (isEnsuring) return;
                isEnsuring = true;
                
                try {
                    // Ensure loader exists
                    if (!document.getElementById('loader')) {
                        const loader = document.createElement('div');
                        loader.id = 'loader';
                        loader.innerHTML = '<div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div>';
                        loader.style.display = 'none';
                        document.body.appendChild(loader);
                    }
                    
                    // Horizontal menu should already exist in HTML, but check anyway
                    if (!document.querySelector('.horizontal-menu')) {
                        const headerContainer = document.querySelector('.main-header-container');
                        if (headerContainer) {
                            const headerCenter = document.createElement('div');
                            headerCenter.className = 'main-header-center d-none d-lg-block';
                            headerCenter.style.display = 'none';
                            const horizontalMenu = document.createElement('nav');
                            horizontalMenu.className = 'horizontal-menu';
                            const ul = document.createElement('ul');
                            ul.className = 'horizontal-list';
                            horizontalMenu.appendChild(ul);
                            headerCenter.appendChild(horizontalMenu);
                            headerContainer.appendChild(headerCenter);
                        }
                    }
                    
                    // Ensure switcher-canvas exists
                    if (!document.getElementById('switcher-canvas')) {
                        const switcher = document.createElement('div');
                        switcher.className = 'offcanvas offcanvas-end';
                        switcher.id = 'switcher-canvas';
                        switcher.setAttribute('tabindex', '-1');
                        switcher.setAttribute('aria-labelledby', 'offcanvasRightLabel');
                        switcher.innerHTML = '<div class="offcanvas-header border-bottom"><h5 class="offcanvas-title text-default" id="offcanvasRightLabel">Switcher</h5><button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button></div><div class="offcanvas-body"></div>';
                        document.body.appendChild(switcher);
                    }
                    
                    // Ensure header-sidebar exists
                    if (!document.getElementById('header-sidebar')) {
                        const headerSidebar = document.createElement('div');
                        headerSidebar.className = 'offcanvas offcanvas-end';
                        headerSidebar.id = 'header-sidebar';
                        headerSidebar.setAttribute('tabindex', '-1');
                        headerSidebar.setAttribute('aria-labelledby', 'sidebarLabel');
                        headerSidebar.innerHTML = '<div class="offcanvas-header rounded-0"><h5 class="fs-14 text-uppercase mb-0 fw-semibold" id="sidebarLabel">–ú–µ–Ω—é</h5><button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button></div><div class="offcanvas-body rounded-0 p-0"></div>';
                        document.body.appendChild(headerSidebar);
                    }
                    
                    // Ensure scrollToTop exists
                    if (!document.querySelector('.scrollToTop')) {
                        const scrollToTop = document.createElement('div');
                        scrollToTop.className = 'scrollToTop';
                        scrollToTop.innerHTML = '<span class="arrow"><i class="las la-angle-double-up"></i></span>';
                        document.body.appendChild(scrollToTop);
                    }
                    
                    // Ensure responsive-overlay exists
                    if (!document.getElementById('responsive-overlay')) {
                        const overlay = document.createElement('div');
                        overlay.id = 'responsive-overlay';
                        document.body.appendChild(overlay);
                    }
                    
                    // Hide loader
                    const loader = document.getElementById('loader');
                    if (loader) {
                        loader.style.display = 'none';
                    }
                } catch (e) {
                    console.warn('Error in ensureElements:', e);
                } finally {
                    isEnsuring = false;
                }
            };
            
            // Run on DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    window.ensureElements();
                    setTimeout(window.ensureElements, 100);
                });
            } else {
                window.ensureElements();
                setTimeout(window.ensureElements, 100);
            }
        })();
    </script>
    
    <style>
        /* –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –º–µ–Ω—é –≤–∏–¥–∏–º–æ */
        .app-sidebar {
            display: block !important;
            visibility: visible !important;
        }
        .main-menu {
            display: block !important;
        }
        .side-menu__item {
            display: flex !important;
            align-items: center !important;
            padding: 0.75rem 1.25rem !important;
            color: #495057 !important;
            text-decoration: none !important;
        }
        .side-menu__item:hover {
            background-color: #f8f9fa !important;
        }
        .side-menu__item.active {
            background-color: #e7f1ff !important;
            color: #0d6efd !important;
        }
        .side-menu__icon {
            width: 20px;
            height: 20px;
            margin-right: 0.75rem;
            fill: currentColor;
        }
        .side-menu__label {
            display: block !important;
        }
        .logs-container {
            height: 400px;
            overflow-y: auto;
            background-color: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            padding: 15px;
            border-radius: 0 0 8px 8px;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 3px 0;
            border-bottom: 1px solid #2d2d2d;
        }
        .log-entry:last-child {
            border-bottom: none;
        }
        .log-timestamp {
            color: #858585;
            margin-right: 10px;
        }
        .log-level-info {
            color: #4ec9b0;
        }
        .log-level-warn {
            color: #dcdcaa;
        }
        .log-level-error {
            color: #f48771;
        }
        .log-level-debug {
            color: #569cd6;
        }
        .log-message {
            color: #d4d4d4;
            word-wrap: break-word;
        }
        .qrcode-container {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 8px;
        }
        .qrcode-container img {
            max-width: 300px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
        }
        .chat-list {
            max-height: 400px;
            overflow-y: auto;
        }
        .chat-item {
            cursor: pointer;
            transition: background-color 0.2s;
            padding: 0.5rem;
            border-radius: 4px;
        }
        .chat-item:hover {
            background-color: #f0f0f0;
        }
        .chat-item.selected {
            background-color: #d4edda;
        }
    </style>
</head>

<body>
    <!-- Page Loader -->
    <div id="loader" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
    <!-- Page Loader -->

    <!-- Start Switcher -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="switcher-canvas" aria-labelledby="offcanvasRightLabel">
        <div class="offcanvas-header border-bottom">
            <h5 class="offcanvas-title text-default" id="offcanvasRightLabel">Switcher</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <p>Switcher content</p>
        </div>
    </div>
    <!-- End Switcher -->
    
    <div class="page">
        <!-- app-header -->
        <header class="app-header">
            <div class="main-header-container container-fluid">
                <div class="header-content-left">
                    <!-- Start::header-element -->
                    <div class="header-element">
                        <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é -->
                        <a aria-label="Toggle Sidebar" class="sidemenu-toggle header-link animated-arrow hor-toggle horizontal-navtoggle" data-bs-toggle="sidebar" href="javascript:void(0);">
                            <i class="header-icon fe fe-align-left"></i>
                        </a>
                        <!-- Horizontal Menu Container (—Å–∫—Ä—ã—Ç, –Ω–æ –Ω—É–∂–µ–Ω –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤) -->
                        <div class="main-header-center d-none d-lg-block" style="display: none !important;">
                            <nav class="horizontal-menu">
                                <ul class="horizontal-list"></ul>
                            </nav>
                        </div>
                    </div>
                    <!-- End::header-element -->
                    <!-- Start::header-element -->
                    <div class="header-element">
                        <div class="horizontal-logo">
                            <a href="/" class="header-logo">
                                <span class="desktop-logo">üì± WhatsApp Service</span>
                                <span class="toggle-logo">WhatsApp</span>
                            </a>
                        </div>
                    </div>
                    <!-- End::header-element -->
                </div>
                <!-- End::header-content-left -->
                <!-- Start::header-content-right -->
                <div class="header-content-right">
                    <!-- Start::header-element -->
                    <div class="header-element">
                        <span class="badge bg-success" id="serviceStatusBadge">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                    </div>
                    <!-- End::header-element -->
                </div>
                <!-- End::header-content-right -->
            </div>
            <!-- End::main-header-container -->
        </header>
        <!-- /app-header -->

        <!-- Start::app-sidebar -->
        <aside class="app-sidebar sticky" id="sidebar">
            <!-- Start::main-sidebar-header -->
            <div class="main-sidebar-header">
                <a href="/" class="header-logo">
                    <span class="desktop-logo">üì± WhatsApp</span>
                    <span class="toggle-logo">WA</span>
                </a>
            </div>
            <!-- End::main-sidebar-header -->
            <!-- Start::main-sidebar -->
            <div class="main-sidebar" id="sidebar-scroll">
                <!-- Start::nav -->
                <nav class="main-menu-container nav nav-pills flex-column sub-open">
                    <div class="slide-left" id="slide-left">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#7b8191" width="24" height="24" viewBox="0 0 24 24"> <path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z"></path> </svg>
                    </div>
                    <ul class="main-menu" id="main-menu">
                        <!-- –ú–µ–Ω—é –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ menu.js -->
                    </ul>
                </nav>
                <!-- End::nav -->
            </div>
            <!-- End::main-sidebar -->
        </aside>
        <!-- End::app-sidebar -->

        <!--APP-CONTENT START-->
        <div class="main-content app-content">
            <div class="container-fluid">
                <!-- Page Header -->
                <div class="d-md-flex d-block align-items-center justify-content-between my-4 page-header-breadcrumb">
                    <div class="my-auto">
                        <h5 class="page-title fs-21 mb-1">WhatsApp Service - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h5>
                        <nav>
                            <ol class="breadcrumb mb-0">
                                <li class="breadcrumb-item"><a href="javascript:void(0);">–°–µ—Ä–≤–∏—Å—ã</a></li>
                                <li class="breadcrumb-item active" aria-current="page">WhatsApp Service</li>
                            </ol>
                        </nav>
                    </div>
                </div>
                <!-- Page Header Close -->

                <!-- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card custom-card">
                            <div class="card-header justify-content-between">
                                <div class="card-title">
                                    <i class="fe fe-info me-2"></i>–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                                </div>
                                <div>
                                    <button class="btn btn-sm btn-outline-warning me-2" onclick="reconnectClient()">
                                        <i class="fe fe-refresh-cw me-1"></i> –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="refreshStatus()">
                                        <i class="fe fe-refresh-cw me-1"></i> –û–±–Ω–æ–≤–∏—Ç—å
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <strong>–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong>
                                        <span id="connectionStatus" class="badge bg-primary-transparent ms-2">
                                            <span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞...
                                        </span>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <strong>–ö–ª–∏–µ–Ω—Ç:</strong>
                                        <span id="clientInfo" class="ms-2 text-muted">-</span>
                                    </div>
                                </div>
                                <div id="qrcodeContainer" class="qrcode-container" style="display: none;">
                                    <p class="mb-3"><strong>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong></p>
                                    <img id="qrcodeImage" src="" alt="QR Code">
                                    <p class="text-muted mt-3 small">
                                        –û—Ç–∫—Ä–æ–π—Ç–µ WhatsApp ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –°–≤—è–∑–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ‚Üí –ü—Ä–∏–≤—è–∑–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏ Ollama -->
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card custom-card">
                            <div class="card-header justify-content-between">
                                <div class="card-title">
                                    <i class="fe fe-cpu me-2"></i>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏ Ollama
                                </div>
                                <button class="btn btn-sm btn-outline-secondary" onclick="refreshModelInfo()">
                                    <i class="fe fe-refresh-cw me-1"></i> –û–±–Ω–æ–≤–∏—Ç—å
                                </button>
                            </div>
                            <div class="card-body">
                                <div id="modelInfoContainer">
                                    <div class="text-center py-3">
                                        <span class="loading"></span>
                                        <span class="ms-2">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–æ–¥–µ–ª–∏...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div class="row">
                    <div class="col-xl-6">
                        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API -->
                        <div class="card custom-card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fe fe-settings me-2"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ API
                                </div>
                            </div>
                            <div class="card-body">
                                <form id="apiConfigForm">
                                    <div class="row">
                                        <div class="col-md-12 mb-3">
                                            <label for="apiUrl" class="form-label">API URL</label>
                                            <input type="text" class="form-control" id="apiUrl" 
                                                   placeholder="https://minerhive.ru" required>
                                        </div>
                                        <div class="col-md-12 mb-3">
                                            <label for="apiEndpoint" class="form-label">API Endpoint</label>
                                            <input type="text" class="form-control" id="apiEndpoint" 
                                                   placeholder="/api/webhook/whatsapp" required>
                                        </div>
                                        <div class="col-md-12 mb-3">
                                            <label for="apiKey" class="form-label">API Key (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                                            <input type="text" class="form-control" id="apiKey" 
                                                   placeholder="your-api-key">
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fe fe-save me-1"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6">
                        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è -->
                        <div class="card custom-card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fe fe-file-text me-2"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
                                </div>
                            </div>
                            <div class="card-body">
                                <form id="loggingConfigForm">
                                    <div class="mb-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="logReceivedMessages" checked>
                                            <label class="form-check-label" for="logReceivedMessages">
                                                <strong>–í—ã–≤–æ–¥–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</strong>
                                                <br>
                                                <small class="text-muted">–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ WhatsApp</small>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="logOllamaResponse" checked>
                                            <label class="form-check-label" for="logOllamaResponse">
                                                <strong>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–∞ Ollama</strong>
                                                <br>
                                                <small class="text-muted">–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ Ollama</small>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="skipOwnMessages">
                                            <label class="form-check-label" for="skipOwnMessages">
                                                <strong>–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–∞–º–æ–≥–æ —Å–µ–±—è</strong>
                                                <br>
                                                <small class="text-muted">–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–æ—Ç–æ–º</small>
                                            </label>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fe fe-save me-1"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ì—Ä—É–ø–ø—ã –∏ —á–∞—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ -->
                <div class="row">
                    <div class="col-xl-6">
                        <div class="card custom-card">
                            <div class="card-header justify-content-between">
                                <div class="card-title">
                                    <i class="fe fe-users me-2"></i>–ì—Ä—É–ø–ø—ã
                                </div>
                                <button class="btn btn-sm btn-outline-primary" onclick="refreshChats()">
                                    <i class="fe fe-refresh-cw me-1"></i> –û–±–Ω–æ–≤–∏—Ç—å
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="monitorAllGroups">
                                    <label class="form-check-label" for="monitorAllGroups">
                                        –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –≤—Å–µ –≥—Ä—É–ø–ø—ã
                                    </label>
                                </div>
                                <div class="chat-list" id="groupsList">
                                    <div class="text-center text-muted">
                                        <span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–ø–ø...
                                    </div>
                                </div>
                                <button class="btn btn-success mt-3 w-100" onclick="saveGroupsConfig()">
                                    <i class="fe fe-save me-1"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6">
                        <div class="card custom-card">
                            <div class="card-header justify-content-between">
                                <div class="card-title">
                                    <i class="fe fe-user me-2"></i>–õ–∏—á–Ω—ã–µ —á–∞—Ç—ã
                                </div>
                                <button class="btn btn-sm btn-outline-primary" onclick="refreshChats()">
                                    <i class="fe fe-refresh-cw me-1"></i> –û–±–Ω–æ–≤–∏—Ç—å
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="monitorAllPersonal">
                                    <label class="form-check-label" for="monitorAllPersonal">
                                        –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –≤—Å–µ –ª–∏—á–Ω—ã–µ —á–∞—Ç—ã
                                    </label>
                                </div>
                                <div class="chat-list" id="personalChatsList">
                                    <div class="text-center text-muted">
                                        <span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞ —á–∞—Ç–æ–≤...
                                    </div>
                                </div>
                                <button class="btn btn-success mt-3 w-100" onclick="savePersonalConfig()">
                                    <i class="fe fe-save me-1"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card custom-card border-warning">
                            <div class="card-header bg-warning-transparent">
                                <div class="card-title">
                                    <i class="fe fe-send me-2"></i>–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="text-muted small mb-3">
                                    –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏. –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω–æ –ø—Ä–∏—à–ª–æ –∏–∑ –≥—Ä—É–ø–ø—ã WhatsApp.
                                </p>
                                <form id="testMessageForm">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="testChatName" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞</label>
                                            <input type="text" class="form-control" id="testChatName" 
                                                   placeholder="Test Group" value="Test Group">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="testSenderName" class="form-label">–ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</label>
                                            <input type="text" class="form-control" id="testSenderName" 
                                                   placeholder="Test User" value="Test User">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="testSenderPhone" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</label>
                                            <input type="text" class="form-control" id="testSenderPhone" 
                                                   placeholder="79999999999" value="79999999999">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">–¢–∏–ø —á–∞—Ç–∞</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="testIsGroup" 
                                                       id="testIsGroup" value="true" checked>
                                                <label class="form-check-label" for="testIsGroup">
                                                    –ì—Ä—É–ø–ø–∞
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="testIsGroup" 
                                                       id="testIsPersonal" value="false">
                                                <label class="form-check-label" for="testIsPersonal">
                                                    –õ–∏—á–Ω—ã–π —á–∞—Ç
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="testMessageContent" class="form-label">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</label>
                                        <textarea class="form-control" id="testMessageContent" rows="5" 
                                                  placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä:&#10;–ü—Ä–æ–¥–∞–º –ú–æ—Å–∫–≤–∞ –ë/–£:&#10;1)S19j PRO 104T, 1—à—Ç. 270u;&#10;2)S19j XP 143T, 43—à—Ç. –ø–æ 900u;" required></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-warning">
                                        <i class="fe fe-send me-1"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (—Ç–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è) -->
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card custom-card">
                            <div class="card-header justify-content-between">
                                <div class="card-title">
                                    <i class="fe fe-cpu me-2"></i>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (—Ç–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è)
                                </div>
                                <div>
                                    <span class="badge bg-primary me-2" id="productsCount">0</span>
                                    <button class="btn btn-sm btn-outline-danger me-2" onclick="clearProducts()">
                                        <i class="fe fe-trash-2 me-1"></i> –û—á–∏—Å—Ç–∏—Ç—å
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="refreshProducts()">
                                        <i class="fe fe-refresh-cw me-1"></i> –û–±–Ω–æ–≤–∏—Ç—å
                                    </button>
                                </div>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                                    <table class="table table-striped table-hover mb-0">
                                        <thead class="table-dark sticky-top">
                                            <tr>
                                                <th>–ú–æ–¥–µ–ª—å</th>
                                                <th>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</th>
                                                <th>–•—ç—à—Ä–µ–π—Ç</th>
                                                <th>–¶–µ–Ω–∞</th>
                                                <th>–õ–æ–∫–∞—Ü–∏—è</th>
                                                <th>–í—Ä–µ–º—è</th>
                                            </tr>
                                        </thead>
                                        <tbody id="productsTableBody">
                                            <tr>
                                                <td colspan="6" class="text-center text-muted p-3">
                                                    <span class="loading"></span> –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End::app-content -->
        </div>

        <!-- Footer Start -->
        <footer class="footer mt-auto py-4 bg-white">
            <div class="container-fluid">
                <div class="text-center">
                    <span class="text-muted">WhatsApp Service &copy; 2025</span>
                </div>
            </div>
        </footer>
        <!-- Footer End -->
    </div>

    <!-- Scroll To Top -->
    <div class="scrollToTop">
        <span class="arrow"><i class="las la-angle-double-up"></i></span>
    </div>
    <div id="responsive-overlay"></div>
    <!-- Scroll To Top -->

    <!-- Popper JS -->
    <script src="/bootstrap-theme/assets/libs/@popperjs/core/umd/popper.min.js"></script>
    <script src="/bootstrap-theme/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/bootstrap-theme/assets/libs/node-waves/waves.min.js"></script>
    <script src="/bootstrap-theme/assets/libs/simplebar/simplebar.min.js"></script>
    <!-- Custom JS –¥–ª—è —Ä–∞–±–æ—Ç—ã –º–µ–Ω—é - –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ -->
    <script>
        // –°–æ–∑–¥–∞–µ–º –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π —Å–∫—Ä–∏–ø—Ç–æ–≤
        document.addEventListener('DOMContentLoaded', function() {
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã
            if (typeof window.ensureElements === 'function') {
                window.ensureElements();
                setTimeout(window.ensureElements, 200);
                setTimeout(window.ensureElements, 500);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            setTimeout(function() {
                const scripts = [
                    '/bootstrap-theme/assets/js/defaultmenu.min.js',
                    '/bootstrap-theme/assets/js/custom-switcher.min.js',
                    '/bootstrap-theme/assets/js/custom.js'
                ];
                
                scripts.forEach(function(src) {
                    const script = document.createElement('script');
                    script.src = src;
                    script.onerror = function() {
                        // –¢–∏—Ö–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
                    };
                    document.body.appendChild(script);
                });
            }, 300);
        });
    </script>
    <script src="app.js"></script>
</body>

</html>
